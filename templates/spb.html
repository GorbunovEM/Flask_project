<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cookiesjs/1.4.2/cookies.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <link rel="stylesheet" href="/static/leaflet/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="/static/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri&family=Merriweather:wght@400;700&family=Work+Sans&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
  </head>
  
    <body>
     <header> 
       <h1>Основные параметры ЖК</h1>
       <div>
           <table class="flat_info"> 
                <tr><th>Средняя цена за квартиры:</th><th><span> {{all_flat}} </span></th></tr>
                <tr><td>Цена за 1 ком:</td><td><span> {{oneflat}} </span></td></tr>
                <tr><td>Цена за 2 ком:</td><td><span> {{twoflat}} </span></td></tr>
                <tr><td>Цена за 3 ком:</td><td><span> {{threeflat}} </span></td></tr>
                <tr><td>Цена за больше 4 ком:</td><td><span> {{fourflat}} </span></td></tr>
                <tr><td>Цена за ст:</td><td><span> {{stflat}} </span></td></tr>
          </table>
          <table class="volume_info">
                <tr><th>Информация о продажах</th><th></th></tr>
                <tr><td>Пощадь проданных квартир, кв. м:</td><td><span> {{area_flat}} </span></td></tr>
                <tr><td>Темп продаж, кв.м/кв.</td><td><span> {{temp_flat}} </span></td></tr>
                <tr><td>Кол-во, ед.</td><td><span> {{qunt_flat}} </span></td></tr>
          </table>     
       </div>
   </header> 
   
    <div class="main_part"> 
    <div class="map">
        <h2>Карта ЖК</h2>
                <div id="map"></div>
    </div>
       
    <div class="filter">
        <h2>Фильтры</h2>
        <form method="post" name="filter" target="" id="checkbox-container">
            <input type="submit" value="Отфильтровать" id="btn" class="btn">
            <input type="submit" value="Сбросить фильтры" id="btn2" class="btn">
            <h3>Район</h3>
            <div class="dist" id="dist">
                <ul id="chb1">
                    <li><input type="checkbox" name="dist" value="Адмиралтейский" id="ch1"> Адмиралтейский</li>
                    <li><input type="checkbox" name="dist" value="Василеостровский" id="ch2"> Василеостровский</li>
                    <li><input type="checkbox" name="dist" value="Всеволожский" id="ch3"> Всеволожский</li>
                    <li><input type="checkbox" name="dist" value="Выборгский" id="ch4"> Выборгский</li>
                    <li><input type="checkbox" name="dist" value="Калининский" id="ch5"> Калининский</li>
                    <li><input type="checkbox" name="dist" value="Кировский" id="ch6"> Кировский</li>
                    <li><input type="checkbox" name="dist" value="Колпинский" id="ch7"> Колпинский</li>
                    <li><input type="checkbox" name="dist" value="Красногвардейский" id="ch8"> Красногвардейский</li>
                    <li><input type="checkbox" name="dist" value="Красносельский" id="ch9"> Красносельский</li>
                    <li><input type="checkbox" name="dist" value="Кронштадтский" id="ch10"> Кронштадтский</li>
                    <li><input type="checkbox" name="dist" value="Курортный" id="ch11"> Курортный</li>
                    <li><input type="checkbox" name="dist" value="Московский" id="ch12"> Московский</li>
                    <li><input type="checkbox" name="dist" value="Невский" id="ch13"> Невский</li>
                    <li><input type="checkbox" name="dist" value="Петроградский" id="ch14"> Петроградский</li>
                    <li><input type="checkbox" name="dist" value="Приморский" id="ch15"> Приморский</li>
                    <li><input type="checkbox" name="dist" value="Пушкинский" id="ch16"> Пушкинский</li>
                    <li><input type="checkbox" name="dist" value="Фрунзенский" id="ch19"> Фрунзенский</li>
                    <li><input type="checkbox" name="dist" value="Центральный" id="ch20"> Центральный</li>
                </ul>
            </div>
            <h3>Класс ЖК</h3>
               <ul id="chb2">
                    <li><input type="checkbox" name="class" value="Эконом" id="ch50"> Эконом</li>
                    <li><input type="checkbox" name="class" value="Комфорт" id="ch51"> Комфорт</li>
                    <li><input type="checkbox" name="class" value="Бизнес-" id="ch52"> Бизнес-</li>
                    <li><input type="checkbox" name="class" value="Бизнес" id="ch53"> Бизнес</li>
                    <li><input type="checkbox" name="class" value="Бизнес+" id="ch54"> Бизнес+</li>
                    <li><input type="checkbox" name="class" value="Премиум" id="ch55"> Премиум</li>
                    <li><input type="checkbox" name="class" value="Элит" id="ch56"> Элитный</li>
                </ul> 
            <div>
            <h3>Период сделки</h3>
                <div class="deal">
                    <ul id="chb3">
                        <li><input type="checkbox" name="deal" value="2022 4кв." id="ch57">4 кв. 2022</li>
                        <li><input type="checkbox" name="deal" value="2022 3кв." id="ch58">3 кв. 2022</li>
                        <li><input type="checkbox" name="deal" value="2022 2кв." id="ch59">2 кв. 2022</li>
                        <li><input type="checkbox" name="deal" value="2022 1кв." id="ch60">1 кв. 2022</li>
                        <li><input type="checkbox" name="deal" value="2021 4кв." id="ch61">4 кв. 2021</li>
                        <li><input type="checkbox" name="deal" value="2021 3кв." id="ch62">3 кв. 2021</li>
                        <li><input type="checkbox" name="deal" value="2021 2кв." id="ch63">2 кв. 2021</li>
                        <li><input type="checkbox" name="deal" value="2021 1кв." id="ch64">1 кв. 2021</li>
                        <li><input type="checkbox" name="deal" value="2020 4кв." id="ch65">4 кв. 2020</li>
                        <li><input type="checkbox" name="deal" value="2020 3кв." id="ch66">3 кв. 2020</li>
                        <li><input type="checkbox" name="deal" value="2020 2кв." id="ch67">2 кв. 2020</li>
                        <li><input type="checkbox" name="deal" value="2020 1кв." id="ch68">1 кв. 2020</li>
                    </ul>
                </div>
            </div>
            <div>
                <h3>Период сдачи</h3>
                <div class="finish">
                    <ul>
                    {% for fn in key_finish %}
                        <li id="finish"><input type="checkbox" name="finish" value="{{ fn }}">{{ fn }}</li>
                    {% endfor %}
                    </ul>
                </div>
            </div>            
        </form>
    </div>    
        <div class="chart_main" id="chart_main">
     <h3>График</h3>
<!-- bar chart canvas element -->
        <canvas id="volume" width="750" height="450"></canvas>
        <p id="caption1"></p>
                <script>
      // Global parameters:
      // do not resize the chart canvas when its container does (keep at 600x400px)
        Chart.defaults.global.responsive = false;

      // define the chart data
          var chartData1 = {
            labels : ["2020 4кв." ,"2021 1кв.", "2021 2кв.", "2021 3кв.", "2021 4кв."],
            datasets : [{
                label: 'Стоимость, руб/кв. м',
                fill: true,
                lineTension: 0.1,
                backgroundColor: "rgba(103, 187, 240, 0.4)",
                borderColor: "rgba(103, 187, 240, 1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(103, 187, 240, 1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(103, 187, 240, 1)",
                pointHoverBorderColor: "rgba(103, 187, 240, 1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data : [{% for item1 in values1 %}
                          {{item1}},
                        {% endfor %}],
                spanGaps: false,
                yAxisID: "y-axis-density"
            }, {
                label: 'Реализованная площадь, кв. м',
                fill: true,
                lineTension: 0.1,
                backgroundColor: "rgba(75,192,192,0.4)",
                borderColor: "rgba(75,192,192,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(103, 187, 240, 1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(103, 187, 240, 1)",
                pointHoverBorderColor: "rgba(103, 187, 240, 1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data : [{% for item2 in values2 %}
                          {{item2}},
                        {% endfor %}],
                spanGaps: false,
                yAxisID: "y-axis-gravity"
                }]
          }
          var chartOptions = {
            scales: {
                yAxes: [{
                    id: "y-axis-density"
                     }, {
                    id: "y-axis-gravity"
                    }]
                    }
                };

          // get chart canvas
          var ctx1 = document.getElementById("volume").getContext("2d");
          // create the chart using the chart canvas
          var myChart = new Chart(ctx1, {
            type: 'line',
            data: chartData1,
            options: chartOptions
          });
        </script>
         </div>
    <div class="list_project">
            <h2>Наименование ЖК</h2>
                <div class = name_project >
                    <ul id="link_ul">
                        {% for key, value in key_class.items() %}
                        <li id="link"><a href = "{{ value[0] }}" target="_blank">{{ key }}</a></li>
                        {% endfor %}
                    </ul>
                </div>            
    </div>
    </div> 
  <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
  <script src="/static/js/scripts.js"></script>
    <script type="text/javascript">
var map = L.map('map', {center: [59.938955, 30.315644], zoom: 10});
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'}).addTo(map);
L.control.scale().addTo(map);
var locations = [{% for key, value in key_class.items() %}
["{{key}}", {{value[1]}}, {{value[2]}}],
{% endfor %}];
document.addEventListener('DOMContentLoaded', (event) => {
for (var i = 0; i < locations.length; i++) {marker = new L.marker([locations[i][1], locations[i][2]]).bindPopup(locations[i][0]).addTo(map);}});
    </script>
  </body>
</html>
